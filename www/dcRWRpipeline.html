<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>dcRWRpipeline @ dcGOR 1.0.5</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">


<style type="text/css">

.navbar .brand {
  display: block;
  float: left;
  padding: 8px 20px 12px;
  margin-left: -20px;
  font-size: 20px;
  font-weight: 200;
  line-height: 1;
  color: #999999;
}

.navbar .brand:hover {
  color: #F87217;
  text-decoration: none;
  background-color: transparent;
}

.navbar .nav > li > a:hover {
  color: #F87217;
  text-decoration: underline;
  background-color: transparent;
}

</style>


<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- google analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17338744-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Enlarge image -->
<script type="text/javascript">
    function newWin(url, name, width, height) { 
       
        var left = (screen.width/2)-(width/2);
        var top = (screen.height/2)-(height/2); 
        
        window.open(url,name,'scrollbars=yes,resizable=yes,fullscreen=yes, width=' + width + ', height='+height+', top='+top+', left='+left);
    }
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="index.html">dcGOR 1.0.5</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Home</a></li>
        </ul>
        <ul class="nav">
          <li><a href="install.html"><i class="icon-wrench icon-white"></i> Installation</a></li>
        </ul>
        <ul class="nav">
          <li><a href="docs.html"><i class="icon-book icon-white"></i> Documentations</a></li>
        </ul>
        <ul class="nav">
          <li><a href="demos.html"><i class="icon-play icon-white"></i> Demos</a></li>
        </ul>
        <ul class="nav">
          <li><a href="cite.html"><i class="icon-pencil icon-white"></i> Citation</a></li>
        </ul>
       
        <!-- HTML for GOOLE SEARCH BAR 
        <ul class="nav">
            <div id="search-wrapper">
                <form id="search" method="get" action="http://www.google.com/custom">
                    <div class="search-box">
                        <i class="icon-search icon-white"></i>
                        <input type="text" id="tfq" class="textinput" name="q" size="21" maxlength="120" value="Google Search"/>
                    </div>
                </form>
            </div>
        </ul>
        -->
        
      </div>
    </div>
  </div>
</div>

<!-- CSS styles for standard search box with placeholder text-->
<style type="text/css">
    #search-wrapper {
        width:300px;
        height:40px;
        background-color:transparent;
        margin:0px auto 0;
        border:0px solid #ff0000;
        -moz-border-radius: 2px; /* FF1+ */
        -webkit-border-radius: 2px; /* Saf3-4 */
        border-radius: 2px; /* Opera 10.5, IE 9, Saf5, Chrome */
        position:relative;
    }

    #search {
        background-color:transparent;
        padding:0px;
        height:40px;
        overflow:hidden;
    }

    .search-box {
        width:250px;
        height:32px;
        background-color:transparent;
        margin:2px 7px;
        border:0px solid #cfcfcf;
        -moz-border-radius: 2px; /* FF1+ */
        -webkit-border-radius: 2px; /* Saf3-4 */
        border-radius: 2px; /* Opera 10.5, IE 9, Saf5, Chrome */
        position:relative;
    }

	.textinput{
		margin: 0;
		padding: 5px 15px;
		font-family: Arial, Helvetica, sans-serif;
		font-size:14px;
		color:#999999;
		border:1px solid #f00; border-right:0px;
		border-top-left-radius: 5px 5px;
		border-bottom-left-radius: 5px 5px;
	}
</style>

<!-- JAVASCRIPT to clear search text when the field is clicked -->
<script type="text/javascript">
window.onload = function(){
	//Get submit button
	var submitbutton = document.getElementById("tfq");
	//Add listener to submit button
	if(submitbutton.addEventListener){
		submitbutton.addEventListener("click", function() {
			if (submitbutton.value == 'Google Search'){//Customize this text string to whatever you want
				submitbutton.value = 'dcGOR R ';
			}
		});
	}
}
</script>

<script>
  (function() {
    var cx = '012094530736424854714:k8ieyz4ag4a';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

<div><gcse:search></gcse:search></div>

    <div class="container">
      <header>
        
      </header>
      
      <h2>Function to setup a pipeine to estimate RWR-based contact strength between samples from an input domain-sample data matrix and an input graph</h2>

<div class="row">
  <div class="span8">
  
    <h3>Description</h3>
    <p><code>dcRWRpipeline</code> is supposed to estimate sample relationships (ie.
contact strength between samples) from an input domain-sample matrix
and an input graph (such as a domain-domain semantic network). The
pipeline includes: 1) random walk restart (RWR) of the input graph
using the input matrix as seeds; 2) calculation of contact strength
(inner products of RWR-smoothed columns of input matrix); 3) estimation
of the contact signficance by a randomalisation procedure. It supports
two methods how to use RWR: 'direct' for directly applying RWR in the
given seeds; 'indirectly' for first pre-computing affinity matrix of
the input graph, and then deriving the affinity score. Parallel
computing is also supported for Linux or Mac operating systems.</p>
  
    <h3>Usage</h3>
    <pre>dcRWRpipeline(data, g, method = c("indirect", "direct"), normalise = c("laplacian", 
  "row", "column", "none"), restart = 0.75, normalise.affinity.matrix = c("none", 
      "quantile"), permutation = c("random", "degree"), num.permutation = 100, p.adjust.method = c("BH", 
      "BY", "bonferroni", "holm", "hochberg", "hommel"), adjp.cutoff = 0.05, parallel = TRUE, 
      multicores = NULL, verbose = T)</pre>
    
    <h3>Arguments</h3>
    <dl>
      <dt>data</dt>
      <dd>an input domain-sample data matrix used for seeds. Each
value in input domain-sample matrix does not necessarily have to be
binary (non-zeros will be used as a weight, but should be non-negative
for easy interpretation).</dd>
      <dt>g</dt>
      <dd>an object of class "igraph" or <code><a href='Dnetwork-class.html'>Dnetwork</a></code></dd>
      <dt>method</dt>
      <dd>the method used to calculate RWR. It can be 'direct' for
directly applying RWR, 'indirect' for indirectly applying RWR (first
pre-compute affinity matrix and then derive the affinity score)</dd>
      <dt>normalise</dt>
      <dd>the way to normalise the adjacency matrix of the input
graph. It can be 'laplacian' for laplacian normalisation, 'row' for
row-wise normalisation, 'column' for column-wise normalisation, or
'none'</dd>
      <dt>restart</dt>
      <dd>the restart probability used for RWR. The restart
probability takes the value from 0 to 1, controlling the range from the
starting nodes/seeds that the walker will explore. The higher the
value, the more likely the walker is to visit the nodes centered on the
starting nodes. At the extreme when the restart probability is zero,
the walker moves freely to the neighbors at each step without
restarting from seeds, i.e., following a random walk (RW)</dd>
      <dt>normalise.affinity.matrix</dt>
      <dd>the way to normalise the output
affinity matrix. It can be 'none' for no normalisation, 'quantile' for
quantile normalisation to ensure that columns (if multiple) of the
output affinity matrix have the same quantiles</dd>
      <dt>permutation</dt>
      <dd>how to do permutation. It can be 'degree' for
degree-preserving permutation, 'random' for permutation in random</dd>
      <dt>num.permutation</dt>
      <dd>the number of permutations used to for
generating the distribution of contact strength under randomalisation</dd>
      <dt>p.adjust.method</dt>
      <dd>the method used to adjust p-values. It can be
one of "BH", "BY", "bonferroni", "holm", "hochberg" and "hommel". The
first two methods "BH" (widely used) and "BY" control the false
discovery rate (FDR: the expected proportion of false discoveries
amongst the rejected hypotheses); the last four methods "bonferroni",
"holm", "hochberg" and "hommel" are designed to give strong control of
the family-wise error rate (FWER). Notes: FDR is a less stringent
condition than FWER</dd>
      <dt>adjp.cutoff</dt>
      <dd>the cutoff of adjusted pvalue to construct the
contact graph</dd>
      <dt>parallel</dt>
      <dd>logical to indicate whether parallel computation with
multicores is used. By default, it sets to true, but not necessarily
does so. Partly because parallel backends available will be
system-specific (now only Linux or Mac OS). Also, it will depend on
whether these two packages "foreach" and "doMC" have been installed. It
can be installed via:
<code>source("http://bioconductor.org/biocLite.R");
biocLite(c("foreach","doMC"))</code>. If not yet installed, this option will
be disabled</dd>
      <dt>multicores</dt>
      <dd>an integer to specify how many cores will be
registered as the multicore parallel backend to the 'foreach' package.
If NULL, it will use a half of cores available in a user's computer.
This option only works when parallel computation is enabled</dd>
      <dt>verbose</dt>
      <dd>logical to indicate whether the messages will be
displayed in the screen. By default, it sets to true for display</dd>
    </dl>
    <!-- 
    -->
    
    <!-- 
    <div class="Value">
    -->
      <h3>Value</h3>
      
      <p>an object of class "iContact", a list with following components:
<ul>
<li><code>ratio</code>: a symmetric matrix storing ratio (the observed
against the expected) between pairwise samples
</li>
<li><code>zscore</code>: a symmetric matrix storing zscore between pairwise
samples
</li>
<li><code>pval</code>: a symmetric matrix storing pvalue between pairwise
samples
</li>
<li><code>adjpval</code>: a symmetric matrix storing adjusted pvalue
between pairwise samples
</li>
<li><code>icontact</code>: the constructed contact graph (as an 'igraph'
object) under the cutoff of adjusted value
</li>
<li><code>Amatrix</code>: a pre-computated affinity matrix when using
'inderect' method; NULL otherwise
</li>
<li><code>call</code>: the call that produced this result
</li>
</ul></p>
      <p></p>
    <!-- 
    </div>
    -->
    <!-- 
    <div class="Note">
    -->
      <h3>Note</h3>
      
      <p>The choice of which method to use RWR depends on the number of seed
sets and the number of permutations for statistical test. If the total
product of both numbers are huge, it is better to use 'indrect' method
(for a single run).</p>
    <!-- 
    </div>
    -->
    
    <h3 id="examples">Examples</h3>
    <pre class="examples"><div class='input'># 1) load onto.GOMF (as 'Onto' object)
g <- dcRDataLoader('onto.GOMF')
</div>
<strong class='message'>'onto.GOMF' (from package 'dcGOR' version 1.0.5) has been loaded into the working environment</strong>
<div class='input'>
# 2) load SCOP superfamilies annotated by GOMF (as 'Anno' object)
Anno <- dcRDataLoader('SCOP.sf2GOMF')
</div>
<strong class='message'>'SCOP.sf2GOMF' (from package 'dcGOR' version 1.0.5) has been loaded into the working environment</strong>
<div class='input'>
# 3) prepare for ontology appended with annotation information
dag <- dcDAGannotate(g, annotations=Anno, path.mode="shortest_paths",
verbose=TRUE)
</div>
<strong class='message'>	At level 15, there are 2 nodes, and 3 incoming neighbors.</strong>
<strong class='message'>	At level 14, there are 6 nodes, and 7 incoming neighbors.</strong>
<strong class='message'>	At level 13, there are 8 nodes, and 8 incoming neighbors.</strong>
<strong class='message'>	At level 12, there are 19 nodes, and 22 incoming neighbors.</strong>
<strong class='message'>	At level 11, there are 24 nodes, and 28 incoming neighbors.</strong>
<strong class='message'>	At level 10, there are 53 nodes, and 44 incoming neighbors.</strong>
<strong class='message'>	At level 9, there are 101 nodes, and 81 incoming neighbors.</strong>
<strong class='message'>	At level 8, there are 198 nodes, and 147 incoming neighbors.</strong>
<strong class='message'>	At level 7, there are 367 nodes, and 192 incoming neighbors.</strong>
<strong class='message'>	At level 6, there are 644 nodes, and 221 incoming neighbors.</strong>
<strong class='message'>	At level 5, there are 489 nodes, and 167 incoming neighbors.</strong>
<strong class='message'>	At level 4, there are 246 nodes, and 56 incoming neighbors.</strong>
<strong class='message'>	At level 3, there are 106 nodes, and 13 incoming neighbors.</strong>
<strong class='message'>	At level 2, there are 20 nodes, and 1 incoming neighbors.</strong>
<strong class='message'>	At level 1, there are 1 nodes, and 0 incoming neighbors.</strong>
<div class='input'>
# 4) calculate pair-wise semantic similarity between 10 randomly chosen domains
alldomains <- unique(unlist(nInfo(dag)$annotations))
domains <- sample(alldomains,10)
dnetwork <- dcDAGdomainSim(g=dag, domains=domains,
method.domain="BM.average", method.term="Resnik", parallel=FALSE,
verbose=TRUE)
</div>
<strong class='message'>Start at 2015-07-21 18:54:12</strong>
<strong class='message'></strong>
<strong class='message'>First, extract all annotatable domains (2015-07-21 18:54:12)...</strong>
<strong class='message'>	there are 10 input domains amongst 1083 annotatable domains</strong>
<strong class='message'>Second, pre-compute semantic similarity between 133 terms (forced to be the most specific for each domain) using Resnik method (2015-07-21 18:54:32)...</strong>
<strong class='message'>Last, calculate pair-wise semantic similarity between 10 domains using BM.average method (2015-07-21 18:54:33)...</strong>
<strong class='message'>	1 out of 10 (2015-07-21 18:54:33)</strong>
<strong class='message'>	2 out of 10 (2015-07-21 18:54:33)</strong>
<strong class='message'>	3 out of 10 (2015-07-21 18:54:33)</strong>
<strong class='message'>	4 out of 10 (2015-07-21 18:54:33)</strong>
<strong class='message'>	5 out of 10 (2015-07-21 18:54:33)</strong>
<strong class='message'>	6 out of 10 (2015-07-21 18:54:33)</strong>
<strong class='message'>	7 out of 10 (2015-07-21 18:54:34)</strong>
<strong class='message'>	8 out of 10 (2015-07-21 18:54:34)</strong>
<strong class='message'>	9 out of 10 (2015-07-21 18:54:34)</strong>
<strong class='message'></strong>
<strong class='message'>Finish at 2015-07-21 18:54:34</strong>
<strong class='message'>Runtime in total is: 22 secs
</strong>
<div class='input'>dnetwork
</div>
<div class='output'>An object of S4 class 'Dnetwork'
@adjMatrix: a weighted symmetric matrix of 10 domains X 10 domains 
@nodeInfo (InfoDataFrame)
  nodeNames: 51419 141322 49758 ... 89837 100950 (10 total)
  nodeAttr: id
</div>
<div class='input'>
# 5) estimate RWR dating based sample/term relationships
# define sets of seeds as data
# each seed with equal weight (i.e. all non-zero entries are '1')
data <- data.frame(aSeeds=c(1,0,1,0,1), bSeeds=c(0,0,1,0,1))
rownames(data) <- id(dnetwork)[1:5]
# calcualte their two contact graph
coutput <- dcRWRpipeline(data=data, g=dnetwork, parallel=FALSE)
</div>
<strong class='message'>Start at 2015-07-21 18:54:34</strong>
<strong class='message'></strong>
<strong class='message'>First, RWR on input graph (10 nodes and 35 edges) using input matrix (5 rows and 2 columns) as seeds (2015-07-21 18:54:34)...</strong>
<strong class='message'>	using 'indirect' method to do RWR (2015-07-21 18:54:34)...</strong>
<strong class='message'>Second, calculate contact strength (2015-07-21 18:54:34)...</strong>
<strong class='message'>Third, generate the distribution of contact strength based on 100 permutations on nodes respecting 'random' (2015-07-21 18:54:34)...</strong>
<strong class='message'>	1 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	10 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	20 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	30 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	40 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	50 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	60 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	70 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	80 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	90 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>	100 out of 100 (2015-07-21 18:54:34)</strong>
<strong class='message'>Last, estimate the significance of contact strength: zscore, pvalue, and BH adjusted-pvalue (2015-07-21 18:54:34)...</strong>
<strong class='message'>Also, construct the contact graph under the cutoff 5.0e-02 of adjusted-pvalue (2015-07-21 18:54:34)...</strong>
<strong class='message'>Your input object 'icontact' of class 'igraph' has been converted into an object of class 'Cnetwork'.</strong>
<strong class='message'></strong>
<strong class='message'>Finish at 2015-07-21 18:54:34</strong>
<strong class='message'>Runtime in total is: 0 secs
</strong>
<div class='input'>coutput
</div>
<div class='output'>An object of S4 class 'Coutput', containing following slots:
  @ratio: a matrix of 2 X 2, containing ratio
  @zscore: a matrix of 2 X 2, containing z-scores
  @pvalue: a matrix of 2 X 2, containing p-values
  @adjp: a matrix of 2 X 2, containing adjusted p-values
  @cnetwork: an object of S4 class 'Cnetwork', containing 0 interacting nodes
</div></pre>
  </div>
  
  <div class="span4">
    
    <!-- 
    <ul>
      <li>dcRWRpipeline</li>
    </ul>
    <ul>
      
    </ul> 
    -->
    
    <h2>Source code</h2>
    <a href="javascript:newWin('R/dcRWRpipeline.r', 'R/dcRWRpipeline.r', '1200', '1200')" title="Click to view"><B><code>dcRWRpipeline.r</code></B></a>
    
    <h2>Source man</h2>
    <a href="javascript:newWin('man/dcRWRpipeline.txt', 'man/dcRWRpipeline.txt', '1200', '1200')" title="Click to view"><B><code>dcRWRpipeline.Rd</code></B></a>
    
    <a href="javascript:newWin('man/dcRWRpipeline.pdf', 'man/dcRWRpipeline.pdf', '1200', '1200')" title="Click to view"><B><code>dcRWRpipeline.pdf</code></B></a>
    
    <h2>See also</h2>
    
<code><a href='dcRDataLoader.html'>dcRDataLoader</a></code>, <code><a href='dcDAGannotate.html'>dcDAGannotate</a></code>,
<code><a href='dcDAGdomainSim.html'>dcDAGdomainSim</a></code>, <code><a href='dcConverter.html'>dcConverter</a></code>

    <!--

    <h2>Citation</h2>
    <p>Fang H. (2014) <B>dcGOR: an R package for analysing ontologies and protein domain annotations</B>. <I>PLoS Computational Biology</I> 10(10):e1003929. <a href="http://dx.doi.org/10.1371/journal.pcbi.1003929">doi:10.1371/journal.pcbi.1003929</a>, PMID: <a href="http://www.ncbi.nlm.nih.gov/pubmed/?term=25356683">25356683</a></p>

<p>You may also cite the package as:</p>

<ul>
<li><code>database</code></li>
</ul>

<p>Fang H, Gough J. (2013) <B>dcGO: database of domain-centric ontologies on functions, phenotypes, diseases and more</B>. <I>Nucleic Acids Research</I> 41(Database issue):D536-44. <a href="http://dx.doi.org/10.1093/nar/gks1080">doi:10.1093/nar/gks1080</a>, PMID: <a href="http://www.ncbi.nlm.nih.gov/pubmed/?term=23161684">23161684</a></p>

<ul>
<li><code>web link/URL</code></li>
</ul>

<p>Package &ldquo;dcGOR&rdquo; [<a href="http://cran.r-project.org/package=dcGOR">http://cran.r-project.org/package=dcGOR</a>]</p>

    
    
    <h2>URL</h2>
    <ul>
      <li><a href="http://supfam.org/dcGOR">http://supfam.org/dcGOR</a></li>
      <li><a href=" http://dcgor.r-forge.r-project.org"> http://dcgor.r-forge.r-project.org</a></li>
      <li><a href=" http://cran.r-
project.org/package=dcGOR"> http://cran.r-
project.org/package=dcGOR</a></li>
      <li><a href=" https://github.com/hfang-bristol/dcGOR"> https://github.com/hfang-bristol/dcGOR</a></li>
    </ul>
    
    
    -->
    
  </div>
  
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>

<p><a href="mailto:hfang@well.ox.ac.uk" title="Hai Fang">Hai Fang</a></p>
<p><a href="http://bioinformatics.bris.ac.uk">Computational Genomics Group, Department of Computer Science, University of Bristol, UK</a></p>


      </footer>
    </div>
  </body>
</html>