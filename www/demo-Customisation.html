<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>Demo for customised analysis (InterPro2GO mapping) @ dcGOR 1.0.5</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Hai Fang and Julian Gough">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">


<style type="text/css">

.navbar .brand {
  display: block;
  float: left;
  padding: 8px 20px 12px;
  margin-left: -20px;
  font-size: 20px;
  font-weight: 200;
  line-height: 1;
  color: #999999;
}

.navbar .brand:hover {
  color: #F87217;
  text-decoration: none;
  background-color: transparent;
}

.navbar .nav > li > a:hover {
  color: #F87217;
  text-decoration: underline;
  background-color: transparent;
}

</style>


<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- google analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17338744-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Enlarge image -->
<script type="text/javascript">
    function newWin(url, name, width, height) { 
       
        var left = (screen.width/2)-(width/2);
        var top = (screen.height/2)-(height/2); 
        
        window.open(url,name,'scrollbars=yes,resizable=yes,fullscreen=yes, width=' + width + ', height='+height+', top='+top+', left='+left);
    }
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="index.html">dcGOR 1.0.5</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Home</a></li>
        </ul>
        <ul class="nav">
          <li><a href="install.html"><i class="icon-wrench icon-white"></i> Installation</a></li>
        </ul>
        <ul class="nav">
          <li><a href="docs.html"><i class="icon-book icon-white"></i> Documentations</a></li>
        </ul>
        <ul class="nav">
          <li><a href="demos.html"><i class="icon-play icon-white"></i> Demos</a></li>
        </ul>
        <ul class="nav">
          <li><a href="cite.html"><i class="icon-pencil icon-white"></i> Citation</a></li>
        </ul>
       
        <!-- HTML for GOOLE SEARCH BAR 
        <ul class="nav">
            <div id="search-wrapper">
                <form id="search" method="get" action="http://www.google.com/custom">
                    <div class="search-box">
                        <i class="icon-search icon-white"></i>
                        <input type="text" id="tfq" class="textinput" name="q" size="21" maxlength="120" value="Google Search"/>
                    </div>
                </form>
            </div>
        </ul>
        -->
        
      </div>
    </div>
  </div>
</div>

<!-- CSS styles for standard search box with placeholder text-->
<style type="text/css">
    #search-wrapper {
        width:300px;
        height:40px;
        background-color:transparent;
        margin:0px auto 0;
        border:0px solid #ff0000;
        -moz-border-radius: 2px; /* FF1+ */
        -webkit-border-radius: 2px; /* Saf3-4 */
        border-radius: 2px; /* Opera 10.5, IE 9, Saf5, Chrome */
        position:relative;
    }

    #search {
        background-color:transparent;
        padding:0px;
        height:40px;
        overflow:hidden;
    }

    .search-box {
        width:250px;
        height:32px;
        background-color:transparent;
        margin:2px 7px;
        border:0px solid #cfcfcf;
        -moz-border-radius: 2px; /* FF1+ */
        -webkit-border-radius: 2px; /* Saf3-4 */
        border-radius: 2px; /* Opera 10.5, IE 9, Saf5, Chrome */
        position:relative;
    }

	.textinput{
		margin: 0;
		padding: 5px 15px;
		font-family: Arial, Helvetica, sans-serif;
		font-size:14px;
		color:#999999;
		border:1px solid #f00; border-right:0px;
		border-top-left-radius: 5px 5px;
		border-bottom-left-radius: 5px 5px;
	}
</style>

<!-- JAVASCRIPT to clear search text when the field is clicked -->
<script type="text/javascript">
window.onload = function(){
	//Get submit button
	var submitbutton = document.getElementById("tfq");
	//Add listener to submit button
	if(submitbutton.addEventListener){
		submitbutton.addEventListener("click", function() {
			if (submitbutton.value == 'Google Search'){//Customize this text string to whatever you want
				submitbutton.value = 'dcGOR R ';
			}
		});
	}
}
</script>

<script>
  (function() {
    var cx = '012094530736424854714:k8ieyz4ag4a';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

<div><gcse:search></gcse:search></div>

    <div class="container">
      <header>
        
      </header>
      
      <h2>Demo for customised analysis (InterPro2GO mapping)</h2>

Notes:
<li> All results are based on dcGOR (version 1.0.5). </li>
<li> R scripts (i.e. R expressions) plus necessary comments are highlighted in light cyan, and the rest are outputs in the screen. </li>
<li> Images displayed below may be distorted, but should be normal in your screen. </li>
<li> Functions contained in dcGOR 1.0.5 are hyperlinked in-place and also listed on the right side. </li>

<div class="row">
    <div class="span8">
      <pre>
      <div class='input'># This is a demo for customised analysis using InterPro2GO mapping
# 
# InterPro2GO mapping is derived from manual annotations of InterPro from GO (<a href="http://www.ncbi.nlm.nih.gov/pubmed/22301074" target="22301074">http://www.ncbi.nlm.nih.gov/pubmed/22301074</a>.
# This demo assumes that the user has collected three bits (files) of information:
## 1) InterPro domains (see <a href="http://dcgor.r-forge.r-project.org/data/InterPro/InterPro.txt">InterPro.txt</a>);
## 2) GO Molecular Function (see <a href="http://dcgor.r-forge.r-project.org/data/onto/igraph_GOMF_nodes.txt">igraph_GOMF_nodes.txt</a> for GOMF term information and <a href="http://dcgor.r-forge.r-project.org/data/onto/igraph_GOBP_edges.txt">igraph_GOMF_edges.txt</a> for parent-child relations between GOMF terms);
## 3) Annotations of InterPro domains by GOMF terms (see <a href="http://dcgor.r-forge.r-project.org/data/InterPro/GO.txt">GO.txt</a> for all GO term information and <a href="http://dcgor.r-forge.r-project.org/data/InterPro/Domain2GOMF.txt">Domain2GOMF.txt</a> for annotations)
#
# From this demo, the user can learn how to customise analysis based on their own data (domains, ontology and annotations). The key to this customised analysis is to prepare input files exactly the same as those mentioned above. 
###############################################################################
library(dcGOR)

#---------------------------------------------------------------------------
#---------------------------------------------------------------------------
# Build (domain, ontology and annotations) objects from user-input files
#---------------------------------------------------------------------------
#---------------------------------------------------------------------------

## 1) InterPro domains
domain <- <a href='dcBuildInfoDataFrame.html' target=dcBuildInfoDataFrame>dcBuildInfoDataFrame</a>(input.file="http://dcgor.r-forge.r-project.org/data/InterPro/InterPro.txt", output.file="domain.RData")
</div>
<strong class='message'>An object of S4 class 'InfoDataFrame' has been built and saved into '/Users/hfang/Sites/SUPERFAMILY/dcGO/dcGOR/domain.RData'.</strong>
<div class='input'>domain
</div>
<div class='output'>An object of S4 class 'InfoDataFrame'
  rowNames: IPR000003 IPR000006 IPR000008 ... IPR029784 IPR029785
    (11638 total)
  colNames: id level description
</div>
<div class='input'>## 2) ontology (GO Molecular Function, GOMF)
g <- <a href='dcBuildOnto.html' target=dcBuildOnto>dcBuildOnto</a>(relations.file="http://dcgor.r-forge.r-project.org/data/onto/igraph_GOMF_edges.txt", nodes.file="http://dcgor.r-forge.r-project.org/data/onto/igraph_GOMF_nodes.txt", output.file="ontology.RData")
</div>
<strong class='message'>An object of S4 class 'Onto' has been built and saved into '/Users/hfang/Sites/SUPERFAMILY/dcGO/dcGOR/ontology.RData'.</strong>
<div class='input'>g
</div>
<div class='output'>An object of S4 class 'Onto'
@adjMatrix: a direct matrix of 9595 terms (parents/from) X 9595 terms (children/to) 
@nodeInfo (InfoDataFrame)
  nodeNames: GO:0003674 GO:0000988 GO:0001071 ... GO:0004008 GO:0086037
    (9595 total)
  nodeAttr: term_id term_name term_namespace term_distance
</div>
<div class='input'>## 3) annotations (between InterPro domains and GOMF terms)
Anno <- <a href='dcBuildAnno.html' target=dcBuildAnno>dcBuildAnno</a>(domain_info.file="http://dcgor.r-forge.r-project.org/data/InterPro/InterPro.txt", term_info.file="http://dcgor.r-forge.r-project.org/data/InterPro/GO.txt", association.file="http://dcgor.r-forge.r-project.org/data/InterPro/Domain2GOMF.txt", output.file="annotations.RData")
</div>
<strong class='message'>An object of S4 class 'Anno' has been built and saved into '/Users/hfang/Sites/SUPERFAMILY/dcGO/dcGOR/annotations.RData'.</strong>
<div class='input'>Anno
</div>
<div class='output'>An object of S4 class 'Anno'
@annoData: 8899 domains, 2219 terms 
@termData (InfoDataFrame)
  termNames: GO:0001071 GO:0003824 GO:0004872 ... GO:0015467 GO:0072345
    (2219 total)
  tvarLabels: ID Name Namespace Distance
@domainData (InfoDataFrame)
  domainNames: IPR000003 IPR000006 IPR000008 ... IPR029784 IPR029785
    (8899 total)
  dvarLabels: id level description
</div>
<div class='input'>## In your working directory, you should see three RData-formatted files: "domain.RData", "ontology.RData", "annotations.RData"

#---------------------------------------------------------------------------
#---------------------------------------------------------------------------
# Enrichment analysis
#---------------------------------------------------------------------------
#---------------------------------------------------------------------------

## prepare data and background for enrichment analysis
### randomly select 100 domains as a list of domains of interest
data <- sample(rowNames(domain), 100)
length(data)
</div>
<div class='output'>[1] 100
</div>
<div class='input'>### randomly select 1000 domains as background
background <- sample(rowNames(domain), 1000)
length(background)
</div>
<div class='output'>[1] 1000
</div>
<div class='input'>
## perform enrichment analysis, producing an object of S4 class 'Eoutput'
eoutput <- <a href='dcEnrichment.html' target=dcEnrichment>dcEnrichment</a>(data, background=background, domain.RData='domain.RData', ontology.RData='ontology.RData', annotations.RData='annotations.RData')
</div>
<strong class='message'>Start at 2015-07-23 12:18:56</strong>
<strong class='message'></strong>
<strong class='message'>First, load customised ontology 'ontology.RData', the domain 'domain.RData', and their associations 'annotations.RData' (2015-07-23 12:18:56)...</strong>
<strong class='message'>Second, perform enrichment analysis using HypergeoTest (2015-07-23 12:19:14) ...</strong>
<strong class='message'>	There are 140 terms being used, each restricted within [10,1000] annotations</strong>
<strong class='message'>Last, adjust the p-values using the BH method (2015-07-23 12:19:14) ...</strong>
<strong class='message'>
End at 2015-07-23 12:19:14</strong>
<strong class='message'>Runtime in total is: 18 secs
</strong>
<div class='input'>eoutput
</div>
<div class='output'>An object of S4 class 'Eoutput', containing following slots:
  @domain: 'domain.RData'
  @ontology: 'ontology.RData'
  @term_info: a data.frame of 65 terms X 5 information
  @anno: a list of 65 terms, each storing annotated domains
  @data: a vector containing a group of 73 input domains (annotatable)
  @background: a vector containing a group of 830 background domains (annotatable)
  @overlap: a list of 65 terms, each containing domains overlapped with input domains
  @zscore: a vector of 65 terms, containing z-scores
  @pvalue: a vector of 65 terms, containing p-values
  @adjp: a vector of 65 terms, containing adjusted p-values
In summary, a total of 65 terms ('ontology.RData') are analysed for a group of 73 input domains ('domain.RData')
</div>
<div class='input'>
## view the top 10 significance terms 
view(eoutput, top_num=10, sortBy="pvalue", details=FALSE)
</div>
<div class='output'>              term_id nAnno nGroup nOverlap zscore pvalue adjp
GO:0016866 GO:0016866    11     73        3   2.18  0.011  0.3
GO:0050112 GO:0050112    20     73        4   1.79  0.025  0.3
GO:0016787 GO:0016787   112     73       15   1.85  0.026  0.3
GO:0016746 GO:0016746    14     73        3   1.68  0.028  0.3
GO:0004022 GO:0004022    21     73        4   1.68  0.031  0.3
GO:0015002 GO:0015002    38     73        6   1.56  0.042  0.3
GO:0004518 GO:0004518    16     73        3   1.42  0.044  0.3
GO:0016817 GO:0016817    31     73        5   1.47  0.047  0.3
GO:0016818 GO:0016818    31     73        5   1.47  0.047  0.3
GO:0016462 GO:0016462    31     73        5   1.47  0.047  0.3
                                                                                    term_name
GO:0016866                                                intramolecular transferase activity
GO:0050112                                                  inositol 2-dehydrogenase activity
GO:0016787                                                                 hydrolase activity
GO:0016746                                     transferase activity, transferring acyl groups
GO:0004022                                               alcohol dehydrogenase (NAD) activity
GO:0015002                                              heme-copper terminal oxidase activity
GO:0004518                                                                  nuclease activity
GO:0016817                                      hydrolase activity, acting on acid anhydrides
GO:0016818 hydrolase activity, acting on acid anhydrides, in phosphorus-containing anhydrides
GO:0016462                                                           pyrophosphatase activity
</div>
<div class='input'>### visualise the top 10 significant terms in the ontology hierarchy
### color-coded according to 10-based negative logarithm of adjusted p-values (adjp)
<a href='visEnrichment.html' target=visEnrichment>visEnrichment</a>(eoutput)
</div>
<strong class='message'>Ontology 'ontology.RData' containing 12 nodes/terms (including 5 in query; also highlighted in frame) has been shown in your screen, with colorbar indicating -1*log10(adjusted p-values)</strong>
<a href="javascript:newWin('Customisation-32.png', 'Customisation-32.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:1px solid #EEEEEE;box-shadow:5px 5px 2px #C0C0C0;" src='Customisation-32.png', width="400" /></a>
<div class='input'>
#---------------------------------------------------------------------
#---------------------------------------------------------------------
# Pair-wise semantic similarity between domains
#---------------------------------------------------------------------
#---------------------------------------------------------------------

## prepare for ontology appended with annotation information
dag <- <a href='dcDAGannotate.html' target=dcDAGannotate>dcDAGannotate</a>(g, annotations=Anno, path.mode="shortest_paths", verbose=FALSE)
dag
</div>
<div class='output'>An object of S4 class 'Onto'
@adjMatrix: a direct matrix of 2578 terms (parents/from) X 2578 terms (children/to) 
@nodeInfo (InfoDataFrame)
  nodeNames: GO:0003674 GO:0000988 GO:0001071 ... GO:0015272 GO:0015467
    (2578 total)
  nodeAttr: term_id term_name term_namespace term_distance annotations
    IC
</div>
<div class='input'>## calculate pair-wise semantic similarity between 8 randomly chosen domains
alldomains <- unique(unlist(nInfo(dag)$annotations))
domains <- sample(alldomains,8)
dnetwork <- <a href='dcDAGdomainSim.html' target=dcDAGdomainSim>dcDAGdomainSim</a>(g=dag, domains=domains, method.domain="BM.average", method.term="Resnik", parallel=FALSE, verbose=TRUE)
</div>
<strong class='message'>Start at 2015-07-23 12:19:46</strong>
<strong class='message'></strong>
<strong class='message'>First, extract all annotatable domains (2015-07-23 12:19:46)...</strong>
<strong class='message'>	there are 8 input domains amongst 8899 annotatable domains</strong>
<strong class='message'>Second, pre-compute semantic similarity between 11 terms (forced to be the most specific for each domain) using Resnik method (2015-07-23 12:19:47)...</strong>
<strong class='message'>Last, calculate pair-wise semantic similarity between 8 domains using BM.average method (2015-07-23 12:19:47)...</strong>
<strong class='message'>	1 out of 8 (2015-07-23 12:19:48)</strong>
<strong class='message'>	2 out of 8 (2015-07-23 12:19:48)</strong>
<strong class='message'>	3 out of 8 (2015-07-23 12:19:48)</strong>
<strong class='message'>	4 out of 8 (2015-07-23 12:19:48)</strong>
<strong class='message'>	5 out of 8 (2015-07-23 12:19:48)</strong>
<strong class='message'>	6 out of 8 (2015-07-23 12:19:48)</strong>
<strong class='message'>	7 out of 8 (2015-07-23 12:19:48)</strong>
<strong class='message'></strong>
<strong class='message'>Finish at 2015-07-23 12:19:48</strong>
<strong class='message'>Runtime in total is: 2 secs
</strong>
<div class='input'>dnetwork
</div>
<div class='output'>An object of S4 class 'Dnetwork'
@adjMatrix: a weighted symmetric matrix of 8 domains X 8 domains 
@nodeInfo (InfoDataFrame)
  nodeNames: IPR024652 IPR009042 IPR023527 ... IPR016067 IPR004485 (8
    total)
  nodeAttr: id
</div>
<div class='input'>## convert it to an object of class 'igraph'
ig <- <a href='dcConverter.html' target=dcConverter>dcConverter</a>(dnetwork, from='Dnetwork', to='igraph')
</div>
<strong class='message'>Your input object 'dnetwork' of class 'Dnetwork' has been converted into an object of class 'igraph'.</strong>
<div class='input'>ig
</div>
<div class='output'>IGRAPH UNW- 8 18 -- 
+ attr: name (v/c), id (v/c), weight (e/n)
+ edges (vertex names):
 [1] IPR024652--IPR009042 IPR024652--IPR023527 IPR009042--IPR023527
 [4] IPR024652--IPR008388 IPR009042--IPR008388 IPR023527--IPR008388
 [7] IPR009042--IPR002548 IPR008388--IPR002548 IPR009042--IPR016652
[10] IPR024652--IPR016067 IPR009042--IPR016067 IPR023527--IPR016067
[13] IPR008388--IPR016067 IPR024652--IPR004485 IPR009042--IPR004485
[16] IPR023527--IPR004485 IPR008388--IPR004485 IPR016067--IPR004485
</div>
<div class='input'>## visualise the domain network
### extract edge weight (with 2-digit precision)
x <- signif(E(ig)$weight, digits=2)
### rescale into an interval [1,4] as edge width
edge.width <- 1 + (x-min(x))/(max(x)-min(x))*3
### do visualisation
dnet::visNet(g=ig, vertex.shape="sphere", edge.width=edge.width, edge.label=x, edge.label.cex=0.7)</div>
<a href="javascript:newWin('Customisation-59.png', 'Customisation-59.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:1px solid #EEEEEE;box-shadow:5px 5px 2px #C0C0C0;" src='Customisation-59.png', width="400" /></a>
      </pre>
    </div>

  <div class="span4">

    <h2>Source demo</h2>
    <a href="javascript:newWin('demo/Customisation.r', 'demo/Customisation.r', '1200', '1200')" title="Click to view"><B><code>Customisation.r</code></B></a>
    
    <h2>Functions used in this demo</h2>
    <ul>
      <li><a href="dcBuildInfoDataFrame.html">dcBuildInfoDataFrame</a></li>
      <li><a href="dcBuildOnto.html">dcBuildOnto</a></li>
      <li><a href="dcBuildAnno.html">dcBuildAnno</a></li>
      <li><a href="dcEnrichment.html">dcEnrichment</a></li>
      <li><a href="visEnrichment.html">visEnrichment</a></li>
      <li><a href="dcDAGannotate.html">dcDAGannotate</a></li>
      <li><a href="dcDAGdomainSim.html">dcDAGdomainSim</a></li>
      <li><a href="dcConverter.html">dcConverter</a></li>
    </ul>
    
    <!--
    
    <h2>Citation</h2>
    <p>Fang H. (2014) <B>dcGOR: an R package for analysing ontologies and protein domain annotations</B>. <I>PLoS Computational Biology</I> 10(10):e1003929. <a href="http://dx.doi.org/10.1371/journal.pcbi.1003929">doi:10.1371/journal.pcbi.1003929</a>, PMID: <a href="http://www.ncbi.nlm.nih.gov/pubmed/?term=25356683">25356683</a></p>

<p>You may also cite the package as:</p>

<ul>
<li><code>database</code></li>
</ul>

<p>Fang H, Gough J. (2013) <B>dcGO: database of domain-centric ontologies on functions, phenotypes, diseases and more</B>. <I>Nucleic Acids Research</I> 41(Database issue):D536-44. <a href="http://dx.doi.org/10.1093/nar/gks1080">doi:10.1093/nar/gks1080</a>, PMID: <a href="http://www.ncbi.nlm.nih.gov/pubmed/?term=23161684">23161684</a></p>

<ul>
<li><code>web link/URL</code></li>
</ul>

<p>Package &ldquo;dcGOR&rdquo; [<a href="http://cran.r-project.org/package=dcGOR">http://cran.r-project.org/package=dcGOR</a>]</p>

    

    
    <h2>URL</h2>
    <ul>
      <li><a href="http://supfam.org/dcGOR">http://supfam.org/dcGOR</a></li>
      <li><a href=" http://cran.r-project.org/package=dcGOR"> http://cran.r-project.org/package=dcGOR</a></li>
      <li><a href=" http://
dcgor.r-forge.r-project.org"> http://
dcgor.r-forge.r-project.org</a></li>
      <li><a href=" https://github.com/hfang-bristol/dcGOR"> https://github.com/hfang-bristol/dcGOR</a></li>
    </ul>
    
    <h2>Author</h2>
    Hai Fang and Julian Gough
    
    -->
    
  </div>

</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>

<p><a href="mailto:hfang@well.ox.ac.uk" title="Hai Fang">Hai Fang</a></p>
<p><a href="http://bioinformatics.bris.ac.uk">Computational Genomics Group, Department of Computer Science, University of Bristol, UK</a></p>


      </footer>
    </div>
  </body>
</html>