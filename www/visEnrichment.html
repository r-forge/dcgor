<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>visEnrichment @ dcGOR 1.0.4</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">


<style type="text/css">

.navbar .brand {
  display: block;
  float: left;
  padding: 8px 20px 12px;
  margin-left: -20px;
  font-size: 20px;
  font-weight: 200;
  line-height: 1;
  color: #999999;
}

.navbar .brand:hover {
  color: #F87217;
  text-decoration: none;
  background-color: transparent;
}

.navbar .nav > li > a:hover {
  color: #F87217;
  text-decoration: underline;
  background-color: transparent;
}

</style>


<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- google analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17338744-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Enlarge image -->
<script type="text/javascript">
    function newWin(url, name, width, height) { 
       
        var left = (screen.width/2)-(width/2);
        var top = (screen.height/2)-(height/2); 
        
        window.open(url,name,'scrollbars=yes,resizable=yes,fullscreen=yes, width=' + width + ', height='+height+', top='+top+', left='+left);
    }
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="index.html">dcGOR 1.0.4</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Home</a></li>
        </ul>
        <ul class="nav">
          <li><a href="install.html"><i class="icon-wrench icon-white"></i> Installation</a></li>
        </ul>
        <ul class="nav">
          <li><a href="docs.html"><i class="icon-book icon-white"></i> Documentations</a></li>
        </ul>
        <ul class="nav">
          <li><a href="demos.html"><i class="icon-play icon-white"></i> Demos</a></li>
        </ul>
        <ul class="nav">
          <li><a href="cite.html"><i class="icon-pencil icon-white"></i> Citation</a></li>
        </ul>
       
        <!-- HTML for GOOLE SEARCH BAR 
        <ul class="nav">
            <div id="search-wrapper">
                <form id="search" method="get" action="http://www.google.com/custom">
                    <div class="search-box">
                        <i class="icon-search icon-white"></i>
                        <input type="text" id="tfq" class="textinput" name="q" size="21" maxlength="120" value="Google Search"/>
                    </div>
                </form>
            </div>
        </ul>
        -->
        
      </div>
    </div>
  </div>
</div>

<!-- CSS styles for standard search box with placeholder text-->
<style type="text/css">
    #search-wrapper {
        width:300px;
        height:40px;
        background-color:transparent;
        margin:0px auto 0;
        border:0px solid #ff0000;
        -moz-border-radius: 2px; /* FF1+ */
        -webkit-border-radius: 2px; /* Saf3-4 */
        border-radius: 2px; /* Opera 10.5, IE 9, Saf5, Chrome */
        position:relative;
    }

    #search {
        background-color:transparent;
        padding:0px;
        height:40px;
        overflow:hidden;
    }

    .search-box {
        width:250px;
        height:32px;
        background-color:transparent;
        margin:2px 7px;
        border:0px solid #cfcfcf;
        -moz-border-radius: 2px; /* FF1+ */
        -webkit-border-radius: 2px; /* Saf3-4 */
        border-radius: 2px; /* Opera 10.5, IE 9, Saf5, Chrome */
        position:relative;
    }

	.textinput{
		margin: 0;
		padding: 5px 15px;
		font-family: Arial, Helvetica, sans-serif;
		font-size:14px;
		color:#999999;
		border:1px solid #f00; border-right:0px;
		border-top-left-radius: 5px 5px;
		border-bottom-left-radius: 5px 5px;
	}
</style>

<!-- JAVASCRIPT to clear search text when the field is clicked -->
<script type="text/javascript">
window.onload = function(){
	//Get submit button
	var submitbutton = document.getElementById("tfq");
	//Add listener to submit button
	if(submitbutton.addEventListener){
		submitbutton.addEventListener("click", function() {
			if (submitbutton.value == 'Google Search'){//Customize this text string to whatever you want
				submitbutton.value = 'dcGOR R ';
			}
		});
	}
}
</script>

<script>
  (function() {
    var cx = '012094530736424854714:k8ieyz4ag4a';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

<div><gcse:search></gcse:search></div>

    <div class="container">
      <header>
        
      </header>
      
      <h2>Function to visualise enrichment analysis outputs in the context of the ontology hierarchy</h2>

<div class="row">
  <div class="span8">
  
    <h3>Description</h3>
    <p><code>visEnrichment</code> is supposed to visualise enrichment analysis
outputs (represented as an 'Eoutput' object) in the context of the
ontology hierarchy (direct acyclic graph; DAG). Only part of DAG
induced by those nodes/terms specified in query nodes (and the mode
defining the paths to the root of DAG) will be visualised. Nodes in
query are framed in black (by default), and all nodes (in query plus
induced) will be color-coded according to a given data.type ('zscore';
otherwise taking the form of 10-based negative logarithm for 'adjp' or
'pvalue'). If no nodes in query, the top 5 significant terms (in terms
of adjusted p-value) will be used for visualisation</p>
  
    <h3>Usage</h3>
    <pre>visEnrichment(e, nodes_query = NULL, num_top_nodes = 5, path.mode = c("all_shortest_paths", 
  "shortest_paths", "all_paths"), data.type = c("adjp", "pvalue", "zscore"), height = 7, 
      width = 7, margin = rep(0.1, 4), colormap = c("yr", "bwr", "jet", "gbr", "wyr", 
          "br", "rainbow", "wb", "lightyellow-orange"), ncolors = 40, zlim = NULL, 
      colorbar = T, colorbar.fraction = 0.1, newpage = T, layout.orientation = c("left_right", 
          "top_bottom", "bottom_top", "right_left"), node.info = c("both", "none", 
          "term_id", "term_name", "full_term_name"), graph.node.attrs = NULL, graph.edge.attrs = NULL, 
      node.attrs = NULL)</pre>
    
    <h3>Arguments</h3>
    <dl>
      <dt>e</dt>
      <dd>an object of S4 class <code><a href='Eoutput-class.html'>Eoutput</a></code></dd>
      <dt>nodes_query</dt>
      <dd>a verctor containing a list of nodes/terms in query.
These nodes are used to produce a subgraph of the ontology DAG induced
by them. If NULL, the top significant terms (in terms of p-value) will
be determined by the next 'num_top_nodes'</dd>
      <dt>num_top_nodes</dt>
      <dd>a numeric value specifying the number of the top
significant terms (in terms of p-value) will be used. This parameter
does not work if the previous 'nodes_query' has been specified</dd>
      <dt>path.mode</dt>
      <dd>the mode of paths induced by nodes in query. It can be
"all_paths" for all possible paths to the root, "shortest_paths" for
only one path to the root (for each node in query),
"all_shortest_paths" for all shortest paths to the root (i.e. for each
node, find all shortest paths with the equal lengths)</dd>
      <dt>data.type</dt>
      <dd>a character telling which data type for nodes in query
is used to color-code nodes. It can be one of 'adjp' for adjusted
p-values (by default), 'pvalue' for p-values and 'zscore' for z-scores.
When 'adjp' or 'pvalue' is used, 10-based negative logarithm is taken.
For the style of how to color-code, please see the next arguments:
colormap, ncolors, zlim and colorbar</dd>
      <dt>height</dt>
      <dd>a numeric value specifying the height of device</dd>
      <dt>width</dt>
      <dd>a numeric value specifying the width of device</dd>
      <dt>margin</dt>
      <dd>margins as units of length 4 or 1</dd>
      <dt>colormap</dt>
      <dd>short name for the colormap. It can be one of "yr"
(yellow-red colormap; by default), "jet" (jet colormap), "bwr"
(blue-white-red colormap), "gbr" (green-black-red colormap), "wyr"
(white-yellow-red colormap), "br" (black-red colormap), "wb"
(white-black colormap), and "rainbow" (rainbow colormap, that is,
red-yellow-green-cyan-blue-magenta). Alternatively, any
hyphen-separated HTML color names, e.g. "lightyellow-orange" (by
default), "blue-black-yellow", "royalblue-white-sandybrown",
"darkgreen-white-darkviolet". A list of standard color names can be
found in <a href = 'http://html-color-codes.info/color-names'>http://html-color-codes.info/color-names</a></dd>
      <dt>ncolors</dt>
      <dd>the number of colors specified over the colormap</dd>
      <dt>zlim</dt>
      <dd>the minimum and maximum z/data values for which colors
should be plotted, defaulting to the range of the finite values of z.
Each of the given colors will be used to color an equispaced interval
of this range. The midpoints of the intervals cover the range, so that
values just outside the range will be plotted</dd>
      <dt>colorbar</dt>
      <dd>logical to indicate whether to append a colorbar. If
data is null, it always sets to false</dd>
      <dt>colorbar.fraction</dt>
      <dd>the relative fraction of colorbar block
against the device size</dd>
      <dt>newpage</dt>
      <dd>logical to indicate whether to open a new page. By
default, it sets to true for opening a new page</dd>
      <dt>layout.orientation</dt>
      <dd>the orientation of the DAG layout. It can be
one of "left_right" for the left-right layout (viewed from the DAG root
point; by default), "top_bottom" for the top-bottom layout,
"bottom_top" for the bottom-top layout, and "right_left" for the
right-left layout</dd>
      <dt>node.info</dt>
      <dd>tells the ontology term information used to label
nodes. It can be one of "both" for using both of Term ID and Name (the
first 15 characters; by default), "none" for no node labeling,
"term_id" for using Term ID, "term_name" for using Term Name (the first
15 characters), and "full_term_name" for using the full Term Name</dd>
      <dt>graph.node.attrs</dt>
      <dd>a list of global node attributes. These node
attributes will be changed globally. See 'Note' below for details on
the attributes</dd>
      <dt>graph.edge.attrs</dt>
      <dd>a list of global edge attributes. These edge
attributes will be changed globally. See 'Note' below for details on
the attributes</dd>
      <dt>node.attrs</dt>
      <dd>a list of local edge attributes. These node
attributes will be changed locally; as such, for each attribute, the
input value must be a named vector (i.e. using Term ID as names). See
'Note' below for details on the attributes</dd>
    </dl>
    <!-- 
    -->
    
    <!-- 
    <div class="Value">
    -->
      <h3>Value</h3>
      
      <p>An object of class 'Ragraph'</p>
    <!-- 
    </div>
    -->
    <!-- 
    <div class="Note">
    -->
      <h3>Note</h3>
      
      <p>A list of global node attributes used in "graph.node.attrs":
<ul>
<li>"shape": the shape of the node: "circle", "rectangle", "rect",
"box" and "ellipse"
</li>
<li>"fixedsize": the logical to use only width and height attributes.
By default, it sets to true for not expanding for the width of the
label
</li>
<li>"fillcolor": the background color of the node
</li>
<li>"color": the color for the node, corresponding to the outside
edge of the node
</li>
<li>"fontcolor": the color for the node text/labelings
</li>
<li>"fontsize": the font size for the node text/labelings
</li>
<li>"height": the height (in inches) of the node: 0.5 by default
</li>
<li>"width": the width (in inches) of the node: 0.75 by default
</li>
<li>"style": the line style for the node: "solid", "dashed",
"dotted", "invis" and "bold"
</li>
</ul></p>
      <p>A list of global edge attributes used in "graph.edge.attrs":
<ul>
<li>"color": the color of the edge: gray by default
</li>
<li>"weight": the weight of the edge: 1 by default
</li>
<li>"style": the line style for the edge: "solid", "dashed",
"dotted", "invis" and "bold"
</li>
</ul></p>
      <p>A list of local node attributes used in "node.attrs" (only those named
Term IDs will be changed locally!):
<ul>
<li>"label": a named vector specifying the node text/labelings
</li>
<li>"shape": a named vector specifying the shape of the node:
"circle", "rectangle", "rect", "box" and "ellipse"
</li>
<li>"fixedsize": a named vector specifying whether it sets to true
for not expanding for the width of the label
</li>
<li>"fillcolor": a named vector specifying the background color of
the node
</li>
<li>"color": a named vector specifying the color for the node,
corresponding to the outside edge of the node
</li>
<li>"fontcolor": a named vector specifying the color for the node
text/labelings
</li>
<li>"fontsize": a named vector specifying the font size for the node
text/labelings
</li>
<li>"height": a named vector specifying the height (in inches) of the
node: 0.5 by default
</li>
<li>"width": a named vector specifying the width (in inches) of the
node: 0.75 by default
</li>
<li>"style": a named vector specifying the line style for the node:
"solid", "dashed", "dotted", "invis" and "bold"
</li>
</ul></p>
      <p></p>
    <!-- 
    </div>
    -->
    
    <h3 id="examples">Examples</h3>
    <pre class="examples"><div class='input'># 1) load SCOP.sf (as 'InfoDataFrame' object)
SCOP.sf <- dcRDataLoader('SCOP.sf')
</div>
<strong class='message'>'SCOP.sf' (from package 'dcGOR' version 1.0.4) has been loaded into the working environment</strong>
<div class='input'># randomly select 20 domains
data <- sample(rowNames(SCOP.sf), 20)

# 2) perform enrichment analysis, producing an object of S4 class 'Eoutput'
eoutput <- dcEnrichment(data, domain="SCOP.sf", ontology="GOMF")
</div>
<strong class='message'>Start at 2014-10-24 19:46:49</strong>
<strong class='message'></strong>
<strong class='message'>First, load the ontology 'GOMF', the domain 'SCOP.sf', and their associations (2014-10-24 19:46:49) ...</strong>
<strong class='message'>'onto.GOMF' (from package 'dcGOR' version 1.0.4) has been loaded into the working environment</strong>
<strong class='message'>'SCOP.sf' (from package 'dcGOR' version 1.0.4) has been loaded into the working environment</strong>
<strong class='message'>'SCOP.sf2GOMF' (from package 'dcGOR' version 1.0.4) has been loaded into the working environment</strong>
<strong class='message'>Second, perform enrichment analysis using HypergeoTest (2014-10-24 19:46:54) ...</strong>
<strong class='message'>	There are 811 terms being used, each restricted within [10,1000] annotations</strong>
<strong class='message'>Last, adjust the p-values using the BH method (2014-10-24 19:46:54) ...</strong>
<strong class='message'>
End at 2014-10-24 19:46:54</strong>
<strong class='message'>Runtime in total is: 5 secs
</strong>
<div class='input'>eoutput
</div>
<div class='output'>An object of S4 class 'Eoutput', containing following slots:
  @domain: 'SCOP.sf'
  @ontology: 'GOMF'
  @term_info: a data.frame of 46 terms X 5 information
  @anno: a list of 46 terms, each storing annotated domains
  @data: a vector containing a group of 8 input domains (annotatable)
  @background: a vector containing a group of 1083 background domains (annotatable)
  @overlap: a list of 46 terms, each containing domains overlapped with input domains
  @zscore: a vector of 46 terms, containing z-scores
  @pvalue: a vector of 46 terms, containing p-values
  @adjp: a vector of 46 terms, containing adjusted p-values
In summary, a total of 46 terms ('GOMF') are analysed for a group of 8 input domains ('SCOP.sf')
</div>
<div class='input'>
# 3) visualise the top 10 significant terms
# color-coded according to 10-based negative logarithm of p-values
visEnrichment(eoutput)
</div>
<strong class='message'>Ontology 'GOMF' containing 14 nodes/terms (including 5 in query; also highlighted in frame) has been shown in your screen, with colorbar indicating -1*log10(adjusted p-values)</strong>
<a href="javascript:newWin('visEnrichment-19.png', 'visEnrichment-19.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:1px solid #EEEEEE;box-shadow:5px 5px 2px #C0C0C0;" src='visEnrichment-19.png', width="400" /></a>
<div class='input'># color-coded according to zscore
visEnrichment(eoutput, data.type='zscore')
</div>
<strong class='message'>Ontology 'GOMF' containing 14 nodes/terms (including 5 in query; also highlighted in frame) has been shown in your screen, with colorbar indicating z-scores</strong>
<a href="javascript:newWin('visEnrichment-22.png', 'visEnrichment-22.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:1px solid #EEEEEE;box-shadow:5px 5px 2px #C0C0C0;" src='visEnrichment-22.png', width="400" /></a>
<div class='input'>
# 4) visualise the top 5 significant terms in the ontology hierarchy
nodes_query <- names(sort(adjp(eoutput))[1:5])
visEnrichment(eoutput, nodes_query=nodes_query)
</div>
<strong class='message'>Ontology 'GOMF' containing 6 nodes/terms (including 5 in query; also highlighted in frame) has been shown in your screen, with colorbar indicating -1*log10(adjusted p-values)</strong>
<a href="javascript:newWin('visEnrichment-25.png', 'visEnrichment-25.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:1px solid #EEEEEE;box-shadow:5px 5px 2px #C0C0C0;" src='visEnrichment-25.png', width="400" /></a>
<div class='input'># change the frame color: highlight (framed in blue) nodes/terms in query
nodes.highlight <- rep("blue", length(nodes_query))
names(nodes.highlight) <- nodes_query
visEnrichment(eoutput, nodes_query=nodes_query,
node.attrs=list(color=nodes.highlight))
</div>
<strong class='message'>Ontology 'GOMF' containing 6 nodes/terms (including 5 in query; also highlighted in frame) has been shown in your screen, with colorbar indicating -1*log10(adjusted p-values)</strong>
<a href="javascript:newWin('visEnrichment-28.png', 'visEnrichment-28.png', '1200', '1200')" title="Click to enlarge"><img style="max-width:95%;border:1px solid #EEEEEE;box-shadow:5px 5px 2px #C0C0C0;" src='visEnrichment-28.png', width="400" /></a></pre>
  </div>
  
  <div class="span4">
    
    <!-- 
    <ul>
      <li>visEnrichment</li>
    </ul>
    <ul>
      
    </ul> 
    -->
    
    <h2>Source code</h2>
    <a href="javascript:newWin('R/visEnrichment.r', 'R/visEnrichment.r', '1200', '1200')" title="Click to view"><B><code>visEnrichment.r</code></B></a>
    
    <h2>Source man</h2>
    <a href="javascript:newWin('man/visEnrichment.txt', 'man/visEnrichment.txt', '1200', '1200')" title="Click to view"><B><code>visEnrichment.Rd</code></B></a>
    
    <a href="javascript:newWin('man/visEnrichment.pdf', 'man/visEnrichment.pdf', '1200', '1200')" title="Click to view"><B><code>visEnrichment.pdf</code></B></a>
    
    <h2>See also</h2>
    
<code><a href='dcEnrichment.html'>dcEnrichment</a></code>, <code><a href='dcRDataLoader.html'>dcRDataLoader</a></code>,
<code><a href='dcConverter.html'>dcConverter</a></code>

    <!--

    <h2>Citation</h2>
    <p>Fang H. (2014) <B>dcGOR: an R package for analysing ontologies and protein domain annotations</B>. <I>PLoS Computational Biology</I> (<a href="http://dx.doi.org/10.1371/journal.pcbi.1003929">doi:10.1371/journal.pcbi.1003929</a>)</p>

<p>You may also cite the package as:</p>

<ul>
<li><code>database</code></li>
</ul>

<p>Fang H, Gough J. (2013) dcGO: database of domain-centric ontologies on functions, phenotypes, diseases and more. <I>Nucleic Acids Research</I> 41(Database issue):D536-44 (<a href="http://dx.doi.org/10.1093/nar/gks1080">doi:10.1093/nar/gks1080</a>)</p>

<ul>
<li><code>web link/URL</code></li>
</ul>

<p>Package &ldquo;dcGOR&rdquo; [<a href="http://cran.r-project.org/package=dcGOR">http://cran.r-project.org/package=dcGOR</a>]</p>

    
    
    <h2>URL</h2>
    <ul>
      <li><a href="http://supfam.org/dcGOR">http://supfam.org/dcGOR</a></li>
    </ul>
    
    
    -->
    
  </div>
  
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>

<p><a href="mailto:hfang@cs.bris.ac.uk" title="Hai Fang">Hai Fang</a></p>
<p><a href="http://bioinformatics.bris.ac.uk">Computational Genomics Group, Department of Computer Science, University of Bristol, UK</a></p>


      </footer>
    </div>
  </body>
</html>